import { useSpring, animated } from "react-spring";
import { useState, useEffect } from "react";

import { useAnimatedSVGPath } from "../../hooks/useAnimatedSVGPath";
import { InnerWrapper, Instruction } from "./style";

const InitialPart = ({ color, d, toggle }) => {
  const animationStrokeProps = useAnimatedSVGPath({ toggle });
  const animationFillStyle = useSpring({
    fill: toggle ? color : "#012C43",
    delay: 750
  });

  return (
    <animated.path
      {...animationStrokeProps}
      style={{
        ...animationStrokeProps.style,
        ...animationFillStyle
      }}
      d={d}
    />
  );
};

const ShapePart = ({ color, d, toggle }) => {
  const animationStrokeProps = useAnimatedSVGPath({ toggle });
  const animationFillStyle = useSpring({
    fill: "transparent",
    delay: 500,
    stroke: color,
    strokeWidth: 20
  });

  return (
    <animated.path
      {...animationStrokeProps}
      style={{
        ...animationStrokeProps.style,
        ...animationFillStyle
      }}
      d={d}
    />
  );
};

const Spinner = () => {
  const [toggle, setToggle] = useState(false);

  useEffect(() => {
    setTimeout(() => {
      setToggle(true);
    });
  }, []);

  return (
    <InnerWrapper>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        x="0px"
        y="0px"
        width="100%"
        viewBox="0 0 500 500"
      >
        <ShapePart
          toggle={toggle}
          color="#FFCF34"
          d="M253.571533,0.999997 
        C256.350159,3.000904 258.466827,5.398355 261.086792,6.940992 
        C285.580505,21.362942 310.124481,35.700531 334.725067,49.939671 
        C362.526459,66.031509 390.437683,81.933655 418.229675,98.041626 
        C434.011749,107.188751 449.650696,116.582787 465.680450,126.473282 
        C466.006165,206.394699 466.003662,285.708466 466.010681,365.022217 
        C466.010986,368.685699 466.096130,372.349182 466.141724,376.012634 
        C459.452087,380.159454 452.838013,384.434540 446.058838,388.429474 
        C424.342957,401.226440 402.592590,413.965454 380.804504,426.639130 
        C361.109833,438.095123 341.322784,449.392303 321.623260,460.839905 
        C302.347046,472.041473 283.124756,483.335846 263.891968,494.611969 
        C260.707214,496.479248 257.590027,498.461853 254.720825,500.695587 
        C252.629440,501.000000 250.258896,501.000000 247.444183,501.000000 
        C246.475464,500.033142 246.201385,498.634308 245.389267,498.163452 
        C230.003128,489.242249 214.508667,480.507751 199.129028,471.575531 
        C182.068939,461.667358 165.137650,451.537537 148.083267,441.619446 
        C132.566956,432.595825 116.933395,423.773987 101.401680,414.776611 
        C84.467064,404.966583 67.588676,395.059509 50.689575,385.188202 
        C47.755825,383.474548 45.020702,381.217651 41.877193,380.111633 
        C36.534225,378.231720 35.653835,374.727722 35.844978,369.584930 
        C36.246677,358.777130 35.970573,347.944153 36.082634,336.188538 
        C36.207382,267.261139 36.222939,199.266708 36.228268,131.272278 
        C36.228333,130.444061 36.097008,129.615829 36.027012,128.787613 
        C36.791061,127.268806 37.147850,125.063377 38.379463,124.332863 
        C61.645828,110.532784 84.983444,96.851700 108.374245,83.262932 
        C126.306480,72.845284 144.373230,62.659195 162.306061,52.242554 
        C179.394470,42.316418 196.355179,32.170570 213.432846,22.225744 
        C224.632233,15.704003 235.943039,9.373698 247.188507,2.930689 
        C247.725754,2.622873 248.113235,2.053653 248.285217,1.303083 
        C249.714355,1.000000 251.428711,1.000000 253.571533,0.999997"
        />

        <InitialPart
          toggle={toggle}
          color="#FFCF34"
          d="M306.902802,349.055206 
        C304.478882,349.308838 302.003784,349.971252 299.648529,349.676392 
        C298.000671,349.470062 295.714294,348.319458 295.098419,346.962036 
        C292.434174,341.089905 290.217499,335.009583 287.967987,328.956696 
        C286.939850,326.190186 285.531433,324.629486 282.212097,324.934906 
        C276.148926,325.492828 270.048492,325.952789 263.966309,325.921844 
        C255.881866,325.880768 247.802551,325.222961 239.716278,325.032501 
        C232.890411,324.871704 226.044678,324.768951 219.236877,325.154694 
        C217.439972,325.256500 214.842087,326.874329 214.170273,328.457306 
        C211.345413,335.113800 209.110931,342.020813 206.457626,349.399841 
        C194.116516,349.399841 181.738617,349.399841 168.148056,349.399841 
        C195.322281,279.179291 222.434143,209.119858 249.874344,138.212036 
        C251.054321,139.501038 252.272568,140.283859 252.696243,141.375168 
        C262.195374,165.841934 271.534058,190.371063 281.057678,214.828217 
        C289.179688,235.686005 297.573486,256.437927 305.704529,277.292236 
        C314.883972,300.835571 323.904144,324.441010 332.462708,348.418579 
        C323.588867,348.896912 315.245819,348.976074 306.902802,349.055206 
        M274.697632,293.181213 
        C274.206055,292.351166 273.554413,291.576233 273.246521,290.682861 
        C267.461334,273.896667 261.731171,257.091461 255.954147,240.302429 
        C254.427139,235.864670 252.781845,231.467606 250.811234,225.998230 
        C246.867722,237.292450 243.437439,247.198334 239.950027,257.084076 
        C235.602554,269.407806 231.207977,281.714905 226.403763,294.572174 
        C226.751724,295.021973 227.097672,295.863525 227.447937,295.865295 
        C242.963257,295.945099 258.479034,295.963654 273.994141,295.877441 
        C274.317566,295.875641 274.633636,294.558685 274.697632,293.181213 
        z"
        />
      </svg>

      <Instruction>Please reload the page to see the animation.</Instruction>
    </InnerWrapper>
  );
};

export default Spinner;
